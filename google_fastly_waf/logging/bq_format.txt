{ "timestamp":"%{strftime(\{"%Y-%m-%dT%H:%M:%S"\}, time.start)}V", "url":"%{json.escape(req.url)}V", "request_method":"%{json.escape(req.method)}V", "request_protocol":"%{json.escape(req.proto)}V", "request_referer":"%{json.escape(req.http.referer)}V", "request_user_agent":"%{json.escape(req.http.User-Agent)}V", "response_state":"%{json.escape(fastly_info.state)}V", "response_status":%{resp.status}V, "response_reason":%{if(resp.response, "%22"+json.escape(resp.response)+"%22", "null")}V, "waf_executed": %{if(waf.executed, "true", "false")}V, "ngwaf_agentresponse": "%{if(fastly.ff.visits_this_service == 0, req.http.x-sigsci-agentresponse, resp.http.x-sigsci-agentresponse)}V", "ngwaf_decision_ms": "%{if(fastly.ff.visits_this_service == 0, req.http.x-sigsci-decision-ms, resp.http.x-sigsci-decision-ms)}V", "ngwaf_signals": "%{if(fastly.ff.visits_this_service == 0, req.http.x-sigsci-tags, resp.http.x-sigsci-tags)}V", "response_bytes_written": "%{resp.bytes_written}V", "ja3": "%{tls.client.ja3_md5}V", "ja4": "%{tls.client.ja4}V", "request_client_ip": "%{req.http.Fastly-Client-IP}V", "h2fp":%{json.escape(req.http.h2fp)}V, "ASN":%{json.escape(req.http.asn)}V, "proxy-description":%{json.escape(req.http.proxy-desc)}V,Â "proxy-type":%{json.escape(req.http.proxy-type)}V, "ohfp":%{json.escape(req.http.ohfp)}V }
